<html>
    <body>
        <small>make me invisible</small>
        <script>
            async function getFlowIdResponse(flowId) {
                const response = await fetch(`https://fss.gecompany.com:9031/pf-ws/authn/flows/${flowId}`, {
                    headers: {
                    'X-XSRF-Header': 'PingFederate',
                    },
                    credentials: 'include',
                });

                if (!response.ok) {
                    const text = await response.text();
                    throw new Error(text);
                }

                return response.json()
            }

            window.addEventListener('message', async (event) => {
                const flowId = event.data;
                const flowIdGet = await getFlowIdResponse(flowId);

                console.log(flowIdGet);
                console.log('sending message');
                window.parent.postMessage(flowIdGet, '*')
            })
        </script>
    </body>
</html>